<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AsetKu - Portfolio Manager</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#121212">
    <link rel="apple-touch-icon" href="https://ik.imagekit.io/lloll/icon">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div id="pwa-install-banner" class="install-banner">
        <div class="install-content">
            <span style="font-size: 1.2rem;">ğŸ“²</span>
            <div><strong>Install Aplikasi</strong><span>Akses lebih cepat & offline!</span></div>
        </div>
        <div style="display:flex; align-items:center; gap: 10px;">
            <button onclick="installPWA()" class="btn-install">Install</button>
            <button onclick="closeInstallBanner()" class="btn-close-banner">&times;</button>
        </div>
    </div>

    <div class="header-container">
        <div><h2>Aset Saya</h2></div>
        <div style="text-align:right;">
            <div style="display:flex; align-items:center; justify-content:flex-end; gap:10px;">
                <small style="color:#a0a0a0">Total Kekayaan Bersih</small>
                <button class="btn-icon" onclick="togglePrivacy()" title="Sensor">ğŸ‘ï¸</button>
            </div>
            <span id="grandTotalDisplay" style="font-size:1.8rem; font-weight:bold; color:#fff;">Rp 0</span>
        </div>
    </div>

    <div class="goal-section">
        <div class="goal-header">
            <span>Target: <span id="targetLabel">Rp 0</span></span>
            <button class="btn-tiny" onclick="editGoal()">âœï¸Target</button>
        </div>
        <div class="progress-track"><div id="progressBar" class="progress-fill"></div></div>
    </div>

    <div class="dashboard-grid">
        <div class="summary-card c-reksa"><h4>Reksadana</h4><div class="nilai" id="sum-reksa">Rp 0</div></div>
        <div class="summary-card c-kas"><h4>Bank</h4><div class="nilai" id="sum-kas">Rp 0</div></div>
        <div class="summary-card c-saham"><h4>Saham</h4><div class="nilai" id="sum-saham">Rp 0</div></div>
        <div class="summary-card c-komo"><h4>Emas</h4><div class="nilai" id="sum-komo">Rp 0</div></div>
        <div class="summary-card c-kripto"><h4>Kripto</h4><div class="nilai" id="sum-kripto">Rp 0</div></div>
    </div>

    <div class="action-area" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <button class="btn-big btn-add" onclick="siapkanTambahAset()">â• Tambah</button>
        <button class="btn-big btn-trans" onclick="bukaModal('modalTransaksi')">ğŸ’¸ Transaksi</button>
        <button class="btn-big" style="background:#607d8b; grid-column: 1 / -1;" onclick="bukaModal('modalAvg')">ğŸ§® Kalkulator AVG</button>

        <div class="cloud-card" style="grid-column: 1 / -1;">
            <div class="cloud-header">
                <div class="cloud-title">â˜ï¸ Auto-Sync Google</div>
                <div id="syncStatus" class="status-text">OFFLINE</div>
            </div>
            <button id="gDriveBtn" class="btn-gdrive btn-login-google" onclick="handleGAuth()">Hubungkan Akun</button>
            <button id="btnLogout" class="btn-logout" onclick="logoutGoogle()">Logout</button>
        </div>
    </div>

    <div class="table-container">
        <table>
            <thead><tr><th>Nama Aset</th><th>Nilai</th><th>Aksi</th></tr></thead>
            <tbody id="masterTableBody"></tbody>
        </table>
    </div>

    <div id="modalAvg" class="modal">
        <div class="modal-content">
            <div class="modal-header"><h3>ğŸ§® Kalkulator AVG</h3><button class="close-btn" onclick="tutupModal('modalAvg')">&times;</button></div>
            <div class="form-group"><label>Harga AVG Lama</label><input type="tel" id="avgLama" placeholder="0"></div>
            <div class="form-group"><label>Unit Lama</label><input type="tel" inputmode="decimal" id="unitLama" placeholder="0"></div>
            <hr style="border:0; border-top:1px solid #444; margin:15px 0;">
            <div class="form-group"><label>Harga Baru</label><input type="tel" id="hargaBaru" placeholder="0"></div>
            <div class="form-group"><label>Unit Baru</label><input type="tel" inputmode="decimal" id="unitBaru" placeholder="0"></div>
            <div style="background:#121212; padding:15px; border-radius:8px; text-align:center;">
                <div id="hasilAvg" style="font-size:1.4rem; font-weight:bold; color:#00c853;">Rp 0</div>
            </div>
            <button class="btn-submit" style="background:#607d8b;" onclick="hitungAvgBaru()">Hitung</button>
        </div>
    </div>

    <div id="modalTambah" class="modal">...</div> 
    <div id="modalTransaksi" class="modal">...</div>

    <div id="toast-container"></div>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="script.js"></script>
</body>
</html>
